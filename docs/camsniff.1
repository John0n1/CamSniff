.TH CAMSNIFF 1 "December 2025" "CamSniff 2.2.2" "User Commands"
.SH NAME
camsniff \- automated IP camera reconnaissance and credential auditor
.SH SYNOPSIS
.B camsniff
[
.BR --mode " " mode
]
[
.B --yes
]
[
.BR --targets " " file
]
[
.BR --output-root " " dir
]
[
.BR --run-name " " label
]
[
.BR --interface " " iface
]
[
.BR --report " " format
]
[
.B --encrypt-results
]
[
.BR --encrypt-tool " " tool
]
[
.BR --encrypt-recipient " " id
]
[
.B --smart
]
[
.BR --smart-min " " score
]
[
.BR --smart-max " " count
]
[
.B --ssdp-describe
]
[
.B --skip-credentials
]
[
.B --skip-install
]
[
.B --version
|
.B --help
]

.SH DESCRIPTION
.B CamSniff
combines network discovery, protocol fingerprinting, and credential probing to
surface insecure IP cameras on a local segment.  It orchestrates Nmap RTSP brute
force enumeration, optional Masscan sweeps, Avahi/mDNS discovery, and targeted
TShark captures.  Results are merged with a vendor knowledge base and exported
as JSON, screenshots, and ASCII thumbnails.

CamSniff must be executed with root privileges (\fBsudo camsniff\fR) so that raw
socket capture and Masscan integration work correctly.

.SH OPTIONS
.TP
.B -m, --mode
Selects the discovery profile.  Valid values are
.I stealth
,
.I "stealth+"
,
.I medium
,
.I aggressive
,
.I war
and
.IR nuke .
Each profile tunes the enabled scanners, port ranges, packet rates, credential
budget, and capture durations.  When omitted the balanced
configuration (\fImedium\fR) is used.
.TP
.B -y, --yes
Skips the interactive confirmation banner and begins the scan immediately.
.TP
.B -t, --targets
Loads target IP addresses or CIDR ranges from a JSON/text file.
.TP
.B --output-root
Overrides the base directory used for run artefacts.
.TP
.B --run-name
Appends a label to the run directory name.
.TP
.B --interface
Overrides the capture interface used by tshark.
.TP
.B --skip-credentials
Disables the automated credential probing phase.
.TP
.B --skip-install
Skips automatic dependency installation.
.TP
.B --report
Generate a report in markdown or HTML format.
.TP
.B --encrypt-results
Encrypt the run artefacts (auto-selects age/gpg).
.TP
.B --encrypt-tool
Force the encryption tool to age or gpg.
.TP
.B --encrypt-recipient
Recipient or key id for encryption.
.TP
.B --smart
Enable smart target shaping and confidence ranking.
.TP
.B --smart-min
Minimum smart score required for deeper probes.
.TP
.B --smart-max
Maximum number of smart targets for deeper probes.
.TP
.B --ssdp-describe
Fetch UPnP/SSDP device descriptions for richer fingerprints.
.TP
.B -v, --version
Print the packaged version string and exit.
.TP
.B -h, --help
Display a concise usage summary and exit.

.SH FILES
.TP
.I /usr/lib/camsniff/scripts/camsniff.sh
Main orchestrator executed by the wrapper binary.
.TP
.I /usr/lib/camsniff/scripts/credential-probe.sh
Runs HTTP/RTSP credential checks based on discovery output.
.TP
.I /usr/lib/camsniff/data/catalog/paths.csv
Vendor fingerprint catalogue supplying default credential and CVE metadata.
.TP
.I /usr/lib/camsniff/data/dictionaries/http-paths.txt
Fallback HTTP snapshot templates.
.TP
.I /usr/lib/camsniff/data/dictionaries/usernames.txt,
.I /usr/lib/camsniff/data/dictionaries/passwords.txt
Credential dictionaries used by the probe stage.
.TP
.I /usr/lib/camsniff/scripts/core/port-profiles.sh
Shared port profile definitions for Nmap and Masscan.
.TP
.I ~/dev/results/
Per-run artefact directories containing discovery and credential JSON output,
logs, and thumbnails.

.SH EXAMPLES
.TP
Run the default aggressive profile with interactive confirmation:
.PP
.RS
.nf
sudo camsniff
.fi
.RE
.TP
Launch a medium profile scan without prompts:
.PP
.RS
.nf
sudo camsniff --mode medium --yes
.fi
.RE

.SH SEE ALSO
.BR nmap (1),
.BR masscan (1),
.BR tshark (1)

.SH AUTHOR
Written by John Hauger Mitander (John0n1) <john@on1.no>.
